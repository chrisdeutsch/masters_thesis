% ~ 12 pages
\chapter{Identification of Hadronic Tau Lepton Decays using Neural Networks}
\label{sec:rnn}

This chapter investigates the application of neural networks for tau
identification. First it is shown that a multi-layer perceptron (MLP) can
achieve a classification performance comparable to the optimised BDT from the
previous chapter. Subsequently, novel sequence learning techniques are employed
to create classifiers operating on sequences of reconstructed objects. For this
recurrent neural networks based on the LSTM architecture are used on sequences
of tracks in the ID and clusters of energy in the calorimeter system. In this
context a tau identification algorithm using purely calorimetric information is
developed and its potential application for reducing the trigger-rate of a
di-tau trigger at the \emph{High Luminosity LHC} (HL-LHC) is presented. Finally,
a model combining the multi-layer perceptron and the recurrent networks
operating on track and cluster information is developed.

\section{Identification using Feedforward Neural Networks}
\label{sec:ffnn_id}

Before proceeding to sequence classification techniques, the viability of neural
networks to perform tau identification using simple network architectures is
shown. This will aid as an introduction to important concepts when training
neural networks. Moreover, the resulting network will be used as a building
block in the final model.

The optimised BDT from Chapter~\ref{sec:bdt} is used as a reference for the
investigations in this chapter. Therefore the models are be trained and
evaluated using the same event samples, preselection and reweighting scheme
presented in Section~\ref{sec:bdt_eventsim}. In contrast to the hold-out
validation used in the previous chapter, the full event sample is randomly split
into training, validation and testing samples. The samples have a relative size
of \SI{40}{\percent}, \SI{10}{\percent} and \SI{50}{\percent}, respectively. The
purpose of the training and testing sample is the same as before. The validation
sample is monitored during the training process and used to perform model
selection and early stopping of the training. A separate sample, as opposed to
the testing sample, is used to avoid introducing biases in the performance
measurement on the testing sample. This approach will be used for the remainder
of this and the following chapter.

To reproduce the performance of the BDT-based tau identification a multi-layer
perceptron (MLP) with two hidden layers~(cf.\ Section~\ref{sec:nn_feedforward})
is used. The MLP uses the same input variables used in the optimised BDT.
Moreover, the input variables are standardised by subtracting the mean and
dividing by the standard deviation derived from the distributions in the
training sample. This preprocessing step is important as the gradient descent
algorithm used for training is sensitive to variables on different scales. The
input layer of the MLP consists of 9 (10) neurons corresponding to the input
variables for the 1-prong (3-prong) identification. Both hidden layers of the
MLP have a size of 128 units, which are activated by rectified linear units
(ReLU). A single output neuron using the logistic sigmoid as its activation
function, therefore returning probabilities of a \tauhadvis candidate being
signal. The binary cross-entropy loss function is used and minimised by the
\emph{Adam} optimiser.

In Figure~\ref{fig:roc_mlp_bdt_comparison} the ratio of rejection of the MLP and
the optimised BDT is depicted as a function of the signal efficiency. The
1-prong MLP shows comparable performance above \SI{60}{\percent} signal
efficiency, which approximately corresponds to the tight working point. Over the
intermediate efficiency range the performance degrades slightly. The 3-prong MLP
is consistent with the performance of the optimised BDT identification with a
small improvement at high efficiencies.

\begin{figure}[htb]
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/mlp/mlp_bdt_ratio_1p.pdf}
    \subcaption{1-prong}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/mlp/mlp_bdt_ratio_3p.pdf}
    \subcaption{3-prong}
  \end{subfigure}
  \caption{Ratio of background rejection of the MLP and the optimised BDT as a
    function of signal efficiency. The band indicates the $1\sigma$-interval.}
  \label{fig:roc_mlp_bdt_comparison}
\end{figure}

To summarise, both the 1- and 3-prong MLP achieve similar performance
characteristics as the optimised BDT from Chapter~\ref{sec:bdt}. The results
show that neural networks are a viable method to perform tau identification.

\section{Identification using Recurrent Neural Networks}
\label{sec:rnn_id}

Thus far approaches of tau identification use high-level variables that
summarise properties of reconstructed objects in the detector. This has the
advantage that identification can be understood and investigations into
systematic errors are simplified. However, discriminative power can be lost when
transitioning from low- to high-level variables. Therefore an approach is
presented capturing low-level information by employing sequence classification
techniques. A general description of the method is given and subsequently
applied to reconstructed tracks and clusters in the calorimeter.

\subsection{Motivation and General Description}
\label{sec:rnn_descr}

The variable importance of the BDT-based tau identification in
Section~\ref{sec:bdt_var_importance} shows that a large fraction of the
background rejection can be attributed to variables derived from tracking
information. Examples are the variables sensitive to the decay length of the tau
lepton~$|S_\text{leadtrack}|$ and~$S_\text{T}^\text{flight}$ as well as the
transverse momentum fraction of isolation tracks~$f_\text{iso}^\text{track}$ and
the invariant mass of the track system~$m_\text{track}$. Moreover, during the
preparation of the tau identification for the ATLAS reconstruction release to be
used for the remainder of Run-II, it was observed that tracks classified as
\emph{isolation} offer discriminative power against \tauhadvis candidates from
multijet events. However, instabilities of the \emph{isolation} track category
lead to the necessity to decouple tau identification and the track
classification by introducing the \emph{modified isolation} category. This lead
to an average rejection loss of the order of \SI{20}{\percent} for the 1-prong
identification, while the 3-prong identification was not significantly affected.
Therefore, the aim is to improve the use of isolation information in
reconstructed tracks of \tauhadvis candidates.

For this purpose recurrent neural networks using the LSTM architecture are used
to classify a sequence of objects reconstructed in the detector. The following
will focus on describing the method using tracks in the ID but the use of other
physics objects is analogous. Figure~\ref{fig:track_rnn_schematic} describes the
architecture used in this chapter. Reconstructed \tauhadvis have a number of
associated tracks, which can be interpreted as elements in a sequence. Each
track in the sequence has variables related to the properties of the track,
e.g.\ the transverse momentum of the track. Moreover, the elements can also be
assigned global information about the \tauhadvis candidate like its visible
transverse momentum. The sequence of tracks is sorted according to a
well-defined and physically motivated ordering scheme. For the RNN using track
information a descending~$p_\text{T}^\text{track}$ ordering is used. In practice
the maximum sequence length is limited by truncation.

\begin{figure}[htb]
  \centering
  \includegraphics[scale=0.9]{./figures/rnn/track_rnn_schematic.pdf}
  \caption{Schematic description of a recurrent neural network using individual
    tracks for tau identification.}
  \label{fig:track_rnn_schematic}
\end{figure}

The tracks and the values of their input variables are passed in the predefined
order to a dense layer with shared weights. This layer applies a transformation
on the variables of each individual track, where the parameters of this
transformation are shared between each element in the sequence. It creates a
sequence of intermediate track representations, which are then passed to the
recurrent layer employing the LSTM architecture. The output of the final time
step of the RNN, consisting of a vector of activations, is passed to a dense
layer with one neuron and logistic sigmoid activation. The activation of the
output neuron can then be used to classify the \tauhadvis candidate as signal or
background. \todo{$\tanh$ activation for shared dense and LSTM.}

\subsection{Network using Reconstructed Tracks in the Inner Detector}
\label{sec:rnn_tracks}

The implementation of the RNN employing track information, hereafter abbreviated
as Track--RNN, uses tracks associated with a \tauhadvis, which are tracks in
the~$\Delta R < 0.4$ cone with respect to the tau axis passing a transverse
momentum threshold of \SI{400}{\MeV} from track reconstruction. The variables
attached to each track are summarised in the following:
\begin{description}
\item[Transverse momentum of track and jet] The transverse momentum of the
  track~$p_\text{T}^\text{track}$ as measured in the tracking system is used.
  The inclusion of the track momentum is crucial as it allows the network to
  discriminate between tracks originating from the hard scattering and soft
  processes. Additionally, the transverse momentum of the anti-$k_\text{t}$ jet
  used to seed the \tauhadvis candidate~$p_\text{T}^\text{jet}$ is appended to
  the input variables of each track.

  \todo[inline]{Why jet seed instead of tau at LC scale?}

\item[Impact parameters w.r.t.\ the tau vertex] The transverse~$d_0$ and
  longitudinal impact parameters~$z_0 \sin\theta$ (distance of closest approach
  in the $\rho z$-plane) with respect to the associated primary vertex is used.
  The longitudinal impact parameter is multiplied by~$\sin\theta$,
  where~$\theta$ is the azimuthal angle of the track parametrisation, to account
  for larger errors of~$z_0$ for tracks in the forward region. Impact parameter
  information is important to determine whether a given track originated from
  the tau production vertex. It allows to discriminate between tracks from the
  \tauhad or quark-/gluon-initiated jets and tracks from other interactions
  during the same bunch crossing.

\item[Angular distance to the tau axis] The signed angular distance of the track
  to the tau axis in the longitudinal~$\Delta \eta$ and transverse
  plane~$\Delta \varphi$. The angular distances allow probing the spacial
  isolation of the tracks in a \tauhadvis candidate.

\item[Track quality criteria] The Track--RNN includes basic track quality
  criteria to allow to reject tracks of low reconstruction quality. Therefore,
  the number of hits in the pixel layers~$N_\text{pixel}$ and semiconductor
  tracker~$N_\text{SCT}$ are used.
  % IBL TOO!

\item[Electron probability] The probability of the track originating from an
  electron estimated by a likelihood-based discriminant using high-threshold hit
  information in the TRT~$p_\text{HT}$. It is used to identify tracks
  originating from photon conversion.
\end{description}
Including the track category from the multivariate track classification was also
investigated leading to a small improvement in discrimination power. It is not
included in favour of decoupling the tau identification from track
classification.

Basic transformations are applied to the input variables to make them more
appropriate for the use in neural networks. Therefore, the transverse
momenta~$p_\text{T}^\text{track}$ and $p_\text{T}^\text{jet}$ are
log-transformed. Moreover, only the absolute value of the impact parameters is
used, which is also log-transformed. Similar to the MLP the input variables have
to be standardised. For transverse momenta and impact parameters this is done by
subtracting an offset and dividing by a scale factor. The offset is the mean of
the corresponding quantity in tracks of the training sample and the scale factor
the corresponding standard deviation. Angular distances are scaled into the
$[-1, 1]$-interval and similarly the number of hits in the inner detector
into~$[0, 1]$. The training process is analogous the the MLP and not repeated
here.

The size of the layers in the architecture depicted in
Figure~\ref{fig:track_rnn_schematic} is optimised by observing the validation
loss while varying the number of units in different layers. A configuration
using 32 units in the shared dense layer and 32 units in the LSTM layer shows
decent classification performance, while still being trainable in a reasonable
amount of time. Alternative architectures using bidirectional LSTM and multiple
consecutive LSTM layers were investigated and show only marginal improvements
over the simpler model.

In Figure~\ref{fig:ntracks_tau} the number of tracks associated to a given tau
candidate is depicted. The number of associated tracks can be large especially
for candidates from background events. For practical purposes the sequence of
tracks is truncated to reduce the memory footprint as well as training and
evaluation time of the network. As the tracks are sorted using a descending
$p_\text{T}^\text{track}$-ordering, truncation will only discard low momentum
tracks. Figure~\ref{fig:ntracks_loss} shows the classification power for
different number of tracks used in the model. The leading six tracks show a
significant impact on the discriminative power of the model. After ten tracks no
further improvement is observed. Therefore, the model will use tracks truncated
after the ten leading tracks in transverse track momentum.

\begin{figure}[htb]
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/ntrk_1p.pdf}
    \subcaption{Number of tracks associated to a reconstructed 1-prong tau
      candidate.}
    \label{fig:ntracks_tau}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/nscan/track_1p_3p.pdf}
    \subcaption{Validation loss as a function of the number of tracks used in
      the model.}
    \label{fig:ntracks_loss}
  \end{subfigure}
  \caption{Number of tracks associated to a tau candidate and their impact on
    the discriminative power of the Track--RNN.}
  \label{fig:rnn_ntracks}
\end{figure}

A comparison of the ROC-curves for the BDT- and RNN-based tau identification is
depicted in Figure~\ref{fig:track_rnn_roc_ratios}. Both the 1- and 3-prong
Track--RNN show a performance similar to the optimised BDT. The 1-prong
Track--RNN shows a small improvement in rejection of \num{10} to
\SI{20}{\percent} over the BDT depending on the signal efficiency. In contrast
to this the 3-prong RNN cannot exceed the performance of the optimised BDT, only
capturing \num{80} to \SI{90}{\percent} of rejection. These results indicate
that the available information in tracks is not fully exploited in the current
BDT-based identification.

\begin{figure}[htb]
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/track/roc.pdf}
    \subcaption{ROC-curves for 1-prong (1P) and 3-prong (3P) tau
      identification.}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/track/ratios.pdf}
    \subcaption{Ratio of rejection of the Track--RNN and the optimised BDT.}
  \end{subfigure}
  \caption{Classification performance of the Track--RNN compared to the
    optimised BDT for tau identification.}
  \label{fig:track_rnn_roc_ratios}
\end{figure}

Due to the complexity of the network, interpretation of the model based on the
parameters learned during training is not possible. It must be viewed as a black
box where only the input and the output can be accessed. Nevertheless the
variable importance and linear correlations of output and inputs can be
evaluated to gain a better understanding of the model. In
Table~\ref{tab:var_importance_track_rnn} the importance of the inputs is
estimated by removing groups of related variables and retraining the model. The
increase in validation loss is used to rank the importance of the input
variables. The table shows that the impact parameters and transverse momenta
have a large impact on the loss. They are essential to identify tracks
originating from the hard scattering as opposed to tracks from other
interactions or pile-up. The angular distances~$\Delta \eta$
and~$\Delta \varphi$ show an importance similar to the transverse momenta.
Compared to multijet events, tracks from hadronic tau decays are expected to be
close to the tau axis resulting in small angular distances for tracks
originating from the tau. The number of hits in the ID and the electron
probability~$p_\text{HT}$ shows only a marginal importance in the Track--RNN.

\begin{table}[htb]
  \centering
  {\small\input{./tables/track_rnn_var_importance.tex}}
  \caption{Variable importance of the 1-prong Track--RNN estimated by the
    increase in validation loss when removing groups of input variables.}
  \label{tab:var_importance_track_rnn}
\end{table}

In Figure~\ref{fig:track_rnn_correlations} the correlations of the input
variables for each track in the sequence with the signal
probability~$p_\text{RNN}$ estimated by the Track--RNN is depicted. In hadronic
tau lepton decays the leading tracks in transverse momentum often correspond the
to the charged decay products. This can be seen in the significant change in
correlation after the first or first three tracks for 1- and 3-prong candidates,
respectively. The correlation of the transverse track
momentum~$p_\text{T}^\text{track}$ in Figure~\ref{fig:track_rnn_corr_pt} shows a
positive coefficient for the leading tracks. The positive correlation implies
that candidates with leading tracks with high transverse momentum are more
likely to get assigned a large signal probability~$p_\text{RNN}$ by the model.
In contrast to this, subleading tracks with large transverse momentum tend to
reduce the signal probability, thus are more likely associated with background
tau candidates. Similarly, the distance of closest approach to the primary
vertex in the $\rho z$-plane~$|z_0 \sin\theta|$ in
Figure~\ref{fig:track_rnn_corr_z0} shows that signal events are more likely to
have leading tracks close to the primary vertex, while subleading tracks exhibit
larger distances to the vertex. The same behaviour is observed for the
transverse impact parameter~$|d_0|$ and the $\Delta R$-distance to the tau axis,
which can be calculated using the signed angular distances~$\Delta \eta$ and
$\Delta \varphi$.

\begin{figure}[htb]
  \centering
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/track/pt_corr.pdf}
    \subcaption{Transverse momentum of the track~$p_\text{T}^\text{track}$.}
    \label{fig:track_rnn_corr_pt}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/track/z0_corr.pdf}
    \subcaption{Distance of closest approach to the primary vertex in the
      $\rho z$-plane~$|z_0 \sin\theta|$.}
    \label{fig:track_rnn_corr_z0}
  \end{subfigure}
  \caption{Linear correlation coefficient between input variables and signal
    probability~$p_\text{RNN}$ estimated by the model. The coefficient is
    determined on the testing sample combining signal and background candidates
    with equal total weight.}
  \label{fig:track_rnn_correlations}
\end{figure}

\todo[inline]{Write transition paragraph? Working points deferred to later.}

\subsection{Network using Clusters in the Calorimeter System}
\label{sec:rnn_clusters}

The BDT-based tau identification makes extensive use of calorimetric information
using TopoClusters and collection of cells in the calorimeter. Therefore a
separate network is developed employing TopoClusters associated with the jet
seeding a tau candidate, hereafter called the Cluster--RNN. The variable
selection is given in the following:
\begin{description}
\item[Transverse energy/momentum] Transverse energy of the
  cluster~$E_\text{T}$, transverse momentum of the jet
  seed~$p_\text{T}^\text{jet}$.
\item[Angular distance to the tau axis] $\Delta \eta$, $\Delta \varphi$
\item[Cluster and signal moments] Used as a proxy to cell-level variables like
  $f_\text{cent}$ as cell information unavailable at this step of the analysis
  chain.

  Lateral shower width~$\langle R^2 \rangle$,
  Longitudinal shower width~$\langle \lambda^2 \rangle$,
  Depth of the shower centre~$\lambda_\text{centre}$,
  Mean energy density~$\langle \rho \rangle$,
  Energy fraction of the most energetic cell~$f_\text{max}$~\cite{atlas_topoclustering}
\end{description}
Has been tested energy fractions in PS, EM1, EM2, EM3

% cluster_vars = [
%     ("TauClusters/et_log", et_log, partial(scale, per_obj=False)),
%     ("TauClusters/pt_jetseed_log",
%      partial(Pt_jet_log, var="TauClusters/et", ptvar="TauJets/ptJetSeed"),
%      partial(scale, per_obj=False)),
%     ("TauClusters/dEta", cluster_dEta, partial(constant_scale, scale=0.4)),
%     ("TauClusters/dPhi", cluster_dPhi, partial(constant_scale, scale=0.4)),
%     ("TauClusters/SECOND_R", SECOND_R_log, partial(scale, per_obj=False)),
%     ("TauClusters/SECOND_LAMBDA", SECOND_LAMBDA_log,
%      partial(scale, per_obj=False)),
%     ("TauClusters/FIRST_ENG_DENS", FIRST_ENG_DENS_log,
%      partial(scale, per_obj=False)),
%     ("TauClusters/CENTER_LAMBDA", CENTER_LAMBDA_log,
%      partial(scale, per_obj=False)),
%     ("TauClusters/ENG_FRAC_MAX", None, None)
% ]

\begin{figure}[ht]
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/ncls_1p.pdf}
    \subcaption{Number of clusters associated with the anti-$k_\text{t}$ jet
      used to seed the 1-prong tau candidates.}
  \end{subfigure}%
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/nscan/cluster_1p_3p.pdf}
    \subcaption{Validation loss as a function of the number of clusters used in
      the model.}
  \end{subfigure}
  \caption{Number of clusters associated to a tau candidate and their impact on
    the discriminative power of the Cluster--RNN.}
  \label{fig:rnn_nclusters}
\end{figure}

\todo{Use 6 clusters}

\begin{figure}[ht]
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/cluster/roc.pdf}
    \subcaption{ROC-curves for 1-prong (1P) and 3-prong (3P) tau
      identification.}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/cluster/ratios.pdf}
    \subcaption{Ratio of rejection of the Cluster--RNN and the optimised BDT.}
  \end{subfigure}
  \caption{Classification performance of the Cluster--RNN compared to the optimised
    BDT for tau identification.}
  \label{fig:cluster_rnn_roc_ratios}
\end{figure}

\subsubsection{Di-Tau Identification at the High Luminosity LHC}
\label{sec:hlt_rate_reduction}

The Phase-II upgrade of the LHC called the High Luminosity LHC (HL-LHC) is
foreseen to be finished by 2026. It will increase the instantaneous luminosity
to~\num{5}\,--\,\SI{7.5e34}{\per\square\centi\metre\per\second} at a
centre-of-mass energy
of~$\sqrt{s} = \SI{14}{\TeV}$~\cite{hl_lhc_prelim_design_report}. This
corresponds to a five- to sevenfold increase in luminosity with respect to the
beginning of Run-II and increases the average number of interactions per bunch
crossing to up to \num{200}. The increase in particle density poses a challenge
to the trigger systems and reconstruction algorithms.

An upgrade of the ATLAS trigger with a \emph{Global Trigger System} aims to
provide access to the full calorimeter granularity with topoclustering and jet
finding using iterative jet algorithms in regions of
interest~\cite{phase_2_scoping}. This aims to improve the identification of
physics objects at trigger-level to cope with increasing trigger rates due to
pile-up. Due to the availability of full calorimeter granularity, offline
reconstructed taus can be used to give prospects of the potential performance of
a di-tau trigger in the HL-LHC environment.

A prospective study on the usage of the cluster-based RNN for identification of
taus in a di-tau trigger is given. Offline reconstructed taus are used as an
approximation to the objects at the Phase-II trigger. The study uses simulated
samples of~$\text{Z} / \text{DY} \to \tau \tau$ and dijets at HL-LHC conditions
with centre-of-mass energy~$\sqrt{s}=\SI{14}{\TeV}$ and average interactions per
bunch crossing~$\mu = 200$ (cf.\ Appendix~\ref{app:upgrade_samples}).

The cluster-based RNN identification is retrained on individual tau candidates
in the HL-LHC upgrade samples using the same preselection used for the BDT
identification in Chapter~\ref{sec:bdt} with the exception of any
tracking-related requirements. The leading and subleading tau with respect to
the reconstructed transverse momentum (using Run-II calibrations) are selected
in a given event, while additionally requiring truth-matched hadronic tau decays
for the signal sample. The RNN identification is applied to each tau
individually resulting in two identification scores per event. The leading and
subleading tau~$p_\text{T}$ and identification scores are combined in a logistic
regression to assign a single di-tau identification score to each event.

The accept-rate of \SI{200}{\kilo\hertz} of the higher-level triggers limits the
maximum trigger-rate of the di-tau trigger. Achieving this rate requires
$p_\text{T}$-thresholds on leading and subleading taus as well as application of
the di-tau identification. The thresholds should be kept low to ensure high
signal acceptance for physics analyses. For the purposes of this study a single
cut on the identification score is used to identify di-tau events.

\begin{figure}[htb]
  \centering
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/trigger/pt_rate_reg.pdf}
    \subcaption{Trigger-rate after RNN-based identification as a function of
      leading and subleading tau offline $p_\text{T}$-threshold.}
    \label{fig:rate_vs_thresholds}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/trigger/taueff_reg.pdf}
    \subcaption{Di-tau selection efficiency of RNN-based identification with
      \SI{25}{\GeV} $p_\text{T}$-thresholds with respect to offline
      reconstructed tau lepton pairs measured in $\text{Z} \to \tau\tau$.}
    \label{fig:ditau_trigger_eff}
  \end{subfigure}
  \caption{Feasibility of using TopoClusters for a di-tau trigger at the
    HL-LHC.}
  \label{fig:rnn_ditau_trigger}
\end{figure}

The large dijet production cross section allows the assumption, that all
background events in the simulated sample correspond to a rate equal to the
average bunch crossing rate of~\SI{31.6}{\mega\hertz}. In
Figure~\ref{fig:rate_vs_thresholds} the trigger-rate is shown as a function of
the leading and subleading $p_\text{T}$-thresholds after applying di-tau
identification. The target rate can be achieved with a offline
$p_\text{T}$-threshold of \SI{25}{\GeV} on both taus.
Figure~\ref{fig:ditau_trigger_eff} shows the efficiency of the identification
using the leading and subleading \SI{25}{\GeV} threshold with respect to all
offline reconstructed di-tau pairs. The di-tau efficiency starts to plateau at
true visible transverse momentum~$p_\text{T}^\text{true} > \SI{40}{\GeV}$ of the
leading tau with an efficiency of approximately~\SI{90}{\percent}.

Ref.~\cite{phase_2_scoping} outlines a di-tau trigger with offline
$p_\text{T}$-threshold on the leading and subleading tau of \SI{40}{\GeV} and
\SI{30}{\GeV}, respectively. The approach using the cluster-based RNN
identification achieves the target rate at a reduced $p_\text{T}$-threshold
of~\SI{25}{\GeV}. The efficiency of the selection shows opportunities for
further enhancements by employing a proper tau energy calibration for HL-LHC
conditions and using a more advanced decision threshold for the di-tau
identification. The decision threshold could be loosened with increasing
transverse momentum to ensure a quicker turn-on and full efficiency at
high-$p_\text{t}$.

\subsection{Combined-RNN}
\label{sec:rnn_combined}

\begin{figure}[htb]
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/combined/roc.pdf}
    \subcaption{ROC-curves for 1-prong (1P) and 3-prong (3P) tau identification.}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/combined/ratios.pdf}
    \subcaption{Ratio of rejection of the combined model and the optimised BDT.}
  \end{subfigure}
  \caption{Classification performance of the combined model compared to the
    optimised BDT for tau identification.}
  \label{fig:roc_combined}
\end{figure}

\begin{figure}[htb]
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/combined/rnn_tight_1p.pdf}
    \subcaption{1-prong}
  \end{subfigure}\hfill
  \begin{subfigure}[t]{0.48\textwidth}
    \centering
    \includegraphics{./figures/rnn/combined/rnn_tight_3p.pdf}
    \subcaption{3-prong}
  \end{subfigure}
  \caption{Background rejection at the tight working point as a function of the
    reconstructed tau $p_\text{T}$ at tau energy scale for the BDT- and
    RNN-based identification.}
  \label{fig:combined_working_points}
\end{figure}

\todo[inline]{Does this improve light quark jet rejection?}

\todo[inline]{Have at least an exemplary RNN score in the appendix.}

\todo[inline]{Check whether the missing tau hits in the ID are a problem at
  high-pt.}

\todo[inline]{Pile-up dependency of RNN vs BDT-ID}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "mythesis"
%%% End:
